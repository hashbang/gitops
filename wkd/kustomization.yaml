apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: wkd
resources:
  - github.com/drGrove/docker-wkd/kustomize/advanced?ref=9e0721ef88ed33aac78533bbb5e21f7d9a0c69cd
  - ingress.yaml
patches:
  - target:
      kind: Deployment
      name: wkd
    patch: |-
      - op: add
        path: "/spec/template/spec/containers/0/args/-"
        value: "-m"
      - op: add
        path: "/spec/template/spec/containers/0/args/-"
        value: "hashbang.sh"
images:
  - name: drgrove/wkd
    newTag: v2.2.2@sha256:b00e9e42486efa6e8601f4aff3d61c9417dcaba993411905a4b63cd2dee72f42
  - name: kiwigrid/k8s-sidecar
    newTag: 1.23.1@sha256:a3abe32e22b97204bea08f1137a2c657099cce1eb57c8955ada5e6252b3a35ae
configMapGenerator:
  - name: benharri-key
    options:
      labels:
        wkd: 'enroll'
    files:
      - files/benharri.asc
  - name: dannygrove-key
    options:
      labels:
        wkd: 'enroll'
    files:
      - files/dannygrove.asc
  - name: lrvick-key
    options:
      labels:
        wkd: 'enroll'
    files:
      - files/lrvick.asc
  - name: kellerfuchs-key
    options:
      labels:
        wkd: 'enroll'
    files: [ files/kellerfuchs.asc ]
  - name: ryan-key
    options:
      labels:
        wkd: 'enroll'
    files:
      - files/ryan.asc
